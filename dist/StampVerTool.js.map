{"version":3,"sources":["../src/StampVerTool.js"],"names":["StampVerTool","constructor","log","run","bind","findVersionFile","dir","process","cwd","length","filename","join","existsSync","substring","lastIndexOf","getFullDate","now","year","month","date","getJDate","startYear","toString","replaceTags","str","tags","tagPrefix","tagSuffix","i","tagEnd","tagStart","key","tag","argv","options","string","boolean","alias","default","args","help","info","version","versionFn","existSync","error","resolve","data","json5","promisify","readFile","encoding","parse","message","tz","warning","newMajorMinorPatch","increment","build","major","minor","patch","sequence","buildFormat","revision","Object","entries","forEach","arr","versionDirname","dirname","update","filenames","match","fullFilename","fileType","fileTypes","glob","dot","write","writeFile","updates","content","found","replace","search","name","stringify"],"mappings":"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","file":"StampVerTool.js","sourcesContent":["import parseArgs from 'minimist'\nimport fs from 'fs'\nimport path from 'path'\nimport JSON5 from 'json5'\nimport { fullVersion } from './version'\nimport XRegExp from 'xregexp'\nimport minimatch from 'minimatch'\nimport util from 'util'\nimport moment from 'moment-timezone'\n\nexport class StampVerTool {\n  constructor(log) {\n    this.log = log\n    this.run = this.run.bind(this)\n  }\n\n  findVersionFile() {\n    let dir = process.cwd()\n\n    while (dir.length !== 0) {\n      const filename = path.join(dir, 'version.json5')\n\n      if (fs.existsSync(filename)) {\n        return filename\n      } else {\n        dir = dir.substring(0, dir.lastIndexOf('/'))\n      }\n    }\n\n    return null\n  }\n\n  static getFullDate(now) {\n    return now.year() * 10000 + (now.month() + 1) * 100 + now.date()\n  }\n\n  static getJDate(now, startYear) {\n    return (((now.year() - startYear + 1) * 10000) + (now.month() * 100) + now.date()).toString()\n  }\n\n  static replaceTags(str, tags) {\n    const tagPrefix = '${'\n    const tagSuffix = '}'\n\n    for (let i = str.length - 1; i != -1;) {\n      const tagEnd = str.lastIndexOf(tagSuffix, i)\n\n      if (tagEnd <= 0) {\n        break\n      }\n\n      const tagStart = str.lastIndexOf(tagPrefix, tagEnd - 1)\n\n      if (tagStart < 0) {\n        break\n      }\n\n      const key = str.substring(tagStart + tagPrefix.length, tagEnd)\n      const tag = tags[key]\n\n      if (typeof tag !== 'undefined') {\n        str = str.substring(0, tagStart) + tag + str.substring(tagEnd + tagSuffix.length)\n      }\n\n      i = tagStart - 1\n    }\n    return str\n  }\n\n  async run(argv) {\n    const options = {\n      string: ['increment'],\n      boolean: ['help', 'version', 'update', 'sequence'],\n      alias: {\n        'u': 'update',\n        'i': 'increment',\n        's': 'sequence',\n      },\n      default: {\n        'increment': 'none'\n      }\n    }\n    let args = parseArgs(argv, options)\n\n    if (args.help) {\n      this.log.info(`\nVersion stamper\n\nUsage: stampver [-u] [<version-file>]\n\n<version-file> defaults to 'version.json5'.\n\nWill increment the build and/or revision number and search/replace all other version\nrelated information in a list of files.\n\nSearches for a 'version.json5' file in the current and parent directories and uses\nthat as the root directory for project files. See https://github.com/jlyonsmith/stampver\nfor the format of the version.json5 file.\n\n-u, --update            Actually do the file updates. Defaults to just reporting changes.\n-i, --increment <part>  Also increment one of major, minor or patch parts of version.\n                        Defaults to none.  Updating major will reset minor and patch to zero,\n                        updating minor will just reset patch.\n-s, --sequence          Increment the sequence number. Just a monotonically increasing\n                        number.\n--help                  Displays this help\n--version               Displays tool version\n`)\n      return 0\n    }\n\n    if (args.version) {\n      this.log.info(`v${fullVersion}`)\n      return 0\n    }\n\n    let versionFn = (args['_'].length > 0 ? args['_'][0] : null)\n\n    if (versionFn && !fs.existSync(versionFn)) {\n      this.log.error(`Unable to find file '${versionFn}'`)\n      return -1\n    }\n\n    versionFn = this.findVersionFile()\n\n    if (!versionFn) {\n      this.log.error(`Unable to find version.json5 file in this or parent directories`)\n      return -1\n    }\n\n    versionFn = path.resolve(versionFn)\n\n    if (this.versionFn && !fs.existsSync(this.versionFn)) {\n      this.log.error(`File '${this.versionFn}' does not exist`)\n      return -1\n    }\n\n    this.log.info(`Version file is '${versionFn}''`)\n\n    let data = null\n    try {\n      const json5 = await util.promisify(fs.readFile)(versionFn, { encoding: 'utf8' })\n      data = JSON5.parse(json5)\n    } catch (error) {\n      this.log.error(`'${versionFn}': ${error.message}`)\n      return -1\n    }\n\n    let now = null\n    if (data.tags.tz) {\n      now = moment().tz(data.tags.tz)\n    } else {\n      this.log.warning(\"No 'tz' value set - using local time zone\")\n      now = moment()\n    }\n    const newMajorMinorPatch = (args.increment !== 'none')\n    let build\n\n    if (newMajorMinorPatch) {\n      switch (args.increment) {\n        case 'major':\n          data.tags.major += 1\n          data.tags.minor = 0\n          data.tags.patch = 0\n          break\n        case 'minor':\n          data.tags.minor += 1\n          data.tags.patch = 0\n          break\n        case 'patch':\n          data.tags.patch += 1\n          break\n      }\n    }\n\n    if (args.sequence) {\n      let sequence = data.tags.sequence || 0\n\n      sequence += 1\n      data.tags.sequence = sequence\n    }\n\n    switch (data.buildFormat) {\n      case 'jdate':\n        build = StampVerTool.getJDate(now, data.startYear)\n\n        if (newMajorMinorPatch || data.tags.build !== build) {\n          data.tags.build = build\n          data.tags.revision = 0\n        } else {\n          data.tags.revision += 1\n        }\n        break\n\n      case 'full':\n        build = StampVerTool.getFullDate(now)\n\n        if (newMajorMinorPatch || data.tags.build !== build) {\n          data.tags.build = build\n          data.tags.revision = 0\n        } else {\n          data.tags.revision += 1\n        }\n        break\n\n      case 'incr':\n        if (newMajorMinorPatch) {\n          data.tags.build = 0\n        } else {\n          data.tags.build += 1\n        }\n        data.tags = revision = 0\n        break\n\n      default:\n        this.log.error(`Unknown build number format ${data.buildFormat}. Must be 'jdate', 'full' or 'incr'`)\n        return -1\n    }\n\n    this.log.info('Tags are:')\n\n    Object.entries(data.tags).forEach(arr => {\n      this.log.info(`  ${arr[0]}='${arr[1]}'`)\n    })\n\n    const versionDirname = path.dirname(versionFn)\n\n    this.log.info(`${args.update ? 'Updating' : 'Checking'} file list:`)\n\n    for (let filename of data.filenames) {\n      let match = false\n      const fullFilename = path.resolve(path.join(versionDirname, filename))\n\n      this.log.info(`  ${fullFilename}`)\n\n      for (let fileType of data.fileTypes) {\n        if (!minimatch(filename, fileType.glob, { dot: true })) {\n          continue\n        }\n\n        match = true\n\n        if (fileType.write) {\n          const dirname = path.dirname(fullFilename)\n\n          if (!fs.existsSync(dirname)) {\n            this.log.error(`Directory '${dirname}' does not exist`)\n            return -1\n          }\n\n          if (args.update) {\n            await util.promisify(fs.writeFile)(filename, StampVerTool.replaceTags(fileType.write, data.tags))\n          }\n        } else {\n          if (fs.existsSync(fullFilename)) {\n            const updates = fileType.updates || [fileType.update]\n            let content = await util.promisify(fs.readFile)(fullFilename, { encoding: 'utf8' })\n\n            updates.forEach(update => {\n              let found = false\n              let replace = StampVerTool.replaceTags(update.replace, data.tags)\n              let search = new XRegExp(update.search, 'm')\n              content = XRegExp.replace(content, search, (match) => {\n                found = true\n                return StampVerTool.replaceTags(replace, match)\n              }, 'one')\n\n              if (!found) {\n                this.log.warning(`File type '${fileType.name}' update '${update.search}' did not match anything`)\n              }\n            })\n\n            if (args.update) {\n              await util.promisify(fs.writeFile)(fullFilename, content)\n            }\n          } else {\n            this.log.error(`File '${fullFilename}' does not exist to update`)\n            return -1\n          }\n        }\n\n        if (match) {\n          break\n        }\n      }\n\n      if (!match) {\n        this.log.error(`File '${fullFilename}' has no matching file type`)\n        continue\n      }\n    }\n\n    if (args.update) {\n      await util.promisify(fs.writeFile)(versionFn, JSON5.stringify(data, null, '  '))\n    }\n\n    return 0\n  }\n}\n"]}